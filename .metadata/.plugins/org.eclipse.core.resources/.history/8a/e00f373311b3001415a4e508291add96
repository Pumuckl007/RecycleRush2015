package org.usfirst.frc.team2984.robot;

import edu.wpi.first.wpilibj.CANTalon;
import edu.wpi.first.wpilibj.DriverStation;

public class MecanumDrive {
	
	//The motors
	private CANTalon frontLeftMotor;
	private CANTalon frontRightMotor;
	private CANTalon backLeftMotor;
	private CANTalon backRightMotor;
	
	MecanumDrive(int frontLeftCANId, int frontRightCANId, int backLeftCANId, int backRightCANId){
		this.frontLeftMotor = new CANTalon(frontLeftCANId);
		this.frontRightMotor = new CANTalon(frontRightCANId);
		this.backLeftMotor = new CANTalon(backLeftCANId);
		this.backRightMotor = new CANTalon(backRightCANId);
	}
	
	//Foward -1 to 1, right -1 to 1, rotate 0 to 2PI
	public void drive(double foward, double right, double rotate){
		double power = Math.min(Math.sqrt(foward * foward + (right*right)), 1);
		double angle;
		//Checks if right is 0
		if(right == 0.0){
			if(foward > 0){
				angle = 0;
			} else {
				angle = Math.PI;
			}
		} else {
			angle = Math.atan(foward/right)-Math.PI/2;
		}
		//Calculates power for each motor
		double frontLeftPower = power*Math.sin(angle + (Math.PI/4))+rotate;
		double frontRightPower = power*Math.cos(angle + (Math.PI/4))-rotate;
		double backLeftPower = power*Math.cos(angle + (Math.PI/4))+rotate;
		double backRightPower = power*Math.sin(angle + (Math.PI/4))-rotate;
		DriverStation.reportError("Angle" + angle, false);
		
		//sets power for each motor
		this.frontLeftMotor.set(frontLeftPower);
		this.frontRightMotor.set(frontRightPower);
		this.backLeftMotor.set(backLeftPower);
		this.backRightMotor.set(backRightPower);
		
	}
}
